!function () {
    return function e(t, a, n) {
        function r(i, s) {
            if (!a[i]) {
                if (!t[i]) {
                    var c = "function" == typeof require && require;
                    if (!s && c) return c(i, !0);
                    if (o) return o(i, !0);
                    var u = new Error("Cannot find module '" + i + "'");
                    throw u.code = "MODULE_NOT_FOUND", u
                }
                var l = a[i] = {exports: {}};
                t[i][0].call(l.exports, function (e) {
                    var a = t[i][1][e];
                    return r(a || e)
                }, l, l.exports, e, t, a, n)
            }
            return a[i].exports
        }

        for (var o = "function" == typeof require && require, i = 0; i < n.length; i++) r(n[i]);
        return r
    }
}()({
    1: [function (e, t, a) {
        "use strict";
        Object.defineProperty(a, "__esModule", {value: !0});
        var n = function () {
            function e(e, t) {
                for (var a = 0; a < t.length; a++) {
                    var n = t[a];
                    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n)
                }
            }

            return function (t, a, n) {
                return a && e(t.prototype, a), n && e(t, n), t
            }
        }();
        var r = function () {
            function e() {
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, e)
            }

            return n(e, [{
                key: "init", value: function () {
                    console.log("INIT: "), this.database = firebase.database(), this.framesRef = this.database.ref("frame"), this.framesRef.off()
                }
            }, {
                key: "loadItems", value: function (e) {
                    return console.log("Data: "), this.framesRef = this.database.ref("frame"), this.framesRef.off(), this.framesRef
                }
            }, {
                key: "loadGame", value: function (e) {
                    return this.gameRef = this.database.ref("games/" + e), this.gameRef.off(), this.gameRef
                }
            }, {
                key: "loadGames", value: function () {
                    return this.database || (this.database = firebase.database()), this.gamesRef = this.database.ref("games"), this.gamesRef.off(), this.gamesRef
                }
            }, {
                key: "saveFrame", value: function (e, t, a) {
                    this.framesRef = this.database.ref("frames"), this.framesRef.off(), this.database.ref("frame/" + e + t).set({content: JSON.stringify(a)})
                }
            }, {
                key: "saveGame", value: function (e, t, a) {
                    var n = this;
                    this.gamesRef = this.database.ref("games"), this.gamesRef.off(), this.loadGames().once("value").then(function (r) {
                        var o;
                        o = r.val() && Object.values(r.val()) ? Object.values(r.val()).length + 1 : 1, n.database.ref("games/" + o).set({
                            game: JSON.stringify(e),
                            player: a,
                            score: t,
                            time: Date.now()
                        })
                    })
                }
            }, {
                key: "getFrameObjectsByFrameIdAndType", value: function (e, t) {
                    return this.framesRef = this.database.ref("frame"), this.framesRef.off(), this.framesRef.child(e + t)
                }
            }]), e
        }();
        a.default = r
    }, {}], 2: [function (e, t, a) {
        "use strict";
        Object.defineProperty(a, "__esModule", {value: !0});
        var n = function () {
            function e(e, t) {
                for (var a = 0; a < t.length; a++) {
                    var n = t[a];
                    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n)
                }
            }

            return function (t, a, n) {
                return a && e(t.prototype, a), n && e(t, n), t
            }
        }();
        var r = function () {
            function e(t) {
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, e), this.dao = t
            }

            return n(e, [{
                key: "createRecordTableEl", value: function () {
                    var e = document.createElement("table");
                    return e.className = "recordTable", e.innerHTML = this.createRecordTableHTML(), e.id = "recordTableId", e
                }
            }, {
                key: "createRecordTableHTML", value: function () {
                    var e = '<table  class="table"><thead><tr><th>Player</th><th>Score</th></tr></thead><tbody>',
                        t = this.dao.getStoredData("playerRecordsId");
                    for (var a in t) e += "<tr><td>" + a + "</td><td>" + t[a] + "</td></tr>";
                    return e += "</tbody></table>"
                }
            }, {
                key: "createReplayTableHTML", value: function (e) {
                    for (var t = '<table class="table"><thead><tr><th>Player</th><th>Score</th><th>Time</th></tr></thead><tbody>', a = 0; a < e.length; a++) {
                        var n = e[a].player, r = e[a].score, o = e[a].time;
                        t += "<tr id=" + (a + 1) + '><td><a href="#/showGame">' + n + "</a></td><td>" + r + "</td><td>" + new Date(o).toLocaleString() + "</td></tr>"
                    }
                    return t += "</tbody></table>"
                }
            }, {
                key: "makePlayLastGameButtonVisible", value: function () {
                    document.getElementById("controlsArea").className = "passive", document.getElementById("replayArea").className = "replayArea active"
                }
            }]), e
        }();
        a.default = r
    }, {}], 3: [function (e, t, a) {
        "use strict";
        Object.defineProperty(a, "__esModule", {value: !0});
        var n = function () {
            function e(e, t) {
                for (var a = 0; a < t.length; a++) {
                    var n = t[a];
                    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n)
                }
            }

            return function (t, a, n) {
                return a && e(t.prototype, a), n && e(t, n), t
            }
        }();
        var r = function () {
            function e() {
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, e), this.frameStoreId = "frameStoreId", this.playerRecordsId = "playerRecordsId", this.storage = localStorage
            }

            return n(e, [{
                key: "getStoredData", value: function (e) {
                    return JSON.parse(this.storage.getItem(e))
                }
            }, {
                key: "saveObject", value: function (e, t) {
                    var a = this.getStoredData(this.frameStoreId);
                    return null === a && (a = []), a[t] || (a[t] = {
                        enemies1: [],
                        enemies2: [],
                        hero: {}
                    }), this.addItemToStore(e, a[t]), this.storage.setItem(this.frameStoreId, JSON.stringify(a)), e
                }
            }, {
                key: "addItemToStore", value: function (e, t) {
                    e instanceof EnemyType1 ? t.enemies1.push(e) : e instanceof EnemyType2 ? t.enemies2.push(e) : e instanceof Person && (t.hero = e)
                }
            }, {
                key: "getItemsByFrameId", value: function (e) {
                    return JSON.parse(this.storage.getItem(this.frameStoreId))[e]
                }
            }, {
                key: "clearFrames", value: function () {
                    this.getStoredData(this.frameStoreId);
                    this.storage.setItem(this.frameStoreId, JSON.stringify(null))
                }
            }, {
                key: "saveRecord", value: function (e, t) {
                    var a = this.getStoredData("playerRecordsId");
                    null === a && (a = {});
                    var n = a[t];
                    (!n || n < e) && (a[t] = e), this.storage.setItem(this.playerRecordsId, JSON.stringify(a))
                }
            }]), e
        }();
        a.default = r
    }, {}], 4: [function (e, t, a) {
        "use strict";
        Object.defineProperty(a, "__esModule", {value: !0});
        var n = function () {
            function e(e, t) {
                for (var a = 0; a < t.length; a++) {
                    var n = t[a];
                    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n)
                }
            }

            return function (t, a, n) {
                return a && e(t.prototype, a), n && e(t, n), t
            }
        }();
        var r = function () {
            function e(t) {
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, e), this.routes = t.routes || [], this.eventBus = t.eventBus, this.init()
            }

            return n(e, [{
                key: "init", value: function () {
                    var e = this;
                    window.addEventListener("hashchange", function () {
                        return e.handleUrl(window.location.hash)
                    }), this.handleUrl(window.location.hash)
                }
            }, {
                key: "findPreviousActiveRoute", value: function () {
                    return this.currentRoute
                }
            }, {
                key: "findNewActiveRoute", value: function (e) {
                    var t = e.split("#").pop();
                    return this.routes.find(function (e) {
                        return "string" == typeof e.match ? e.match === t : e.match instanceof RegExp ? e.match.test(t) : "function" == typeof e.match ? e.match(t) : void 0
                    })
                }
            }, {
                key: "getRouteParams", value: function (e, t) {
                    var a = t.match(e.match) || [];
                    return a.shift(), a
                }
            }, {
                key: "handleUrl", value: function (e) {
                    e = e.slice(1);
                    var t = this.findPreviousActiveRoute(), a = this.findNewActiveRoute(e),
                        n = this.getRouteParams(a, e);
                    t && t.onLeave && t.onLeave(this.currentRouteParams), a && a.onBeforeEnter && a.onBeforeEnter(n), a && a.onEnter && a.onEnter(n), this.currentRoute = a, this.currentRouteParams = n
                }
            }]), e
        }();
        a.default = r
    }, {}], 5: [function (e, t, a) {
        "use strict";
        var n, r = e("./script");
        (0, ((n = r) && n.__esModule ? n : {default: n}).default)()
    }, {"./script": 6}], 6: [function (e, t, a) {
        "use strict";
        Object.defineProperty(a, "__esModule", {value: !0}), a.prepareElements = function () {
            location.hash = "/game", f = document.documentElement.clientHeight - document.getElementsByTagName("nav")[0].clientHeight;
            var e = {routes: h};
            new i.default(e);
            this.canvas = document.querySelector("canvas"), u = new GameArena(this.canvas, l, f, Person), document.getElementById("controlsArea").addEventListener("click", function () {
                var e = this.children[0].src;
                e.includes("play") ? (u.start(), this.children[0].src = "img/pause.png") : (u.stop(), this.children[0].src = "img/play.png")
            }), document.getElementById("replayArea").addEventListener("click", function () {
                c || u.replayLastGame(), u.replaySelectedGame(c)
            }), document.getElementById("replaysTableId").addEventListener("click", function () {
                "A" === event.target.tagName && (c = Number(event.target.parentNode.parentNode.id), m.makePlayLastGameButtonVisible())
            })
        };
        var n = s(e("./Dao")), r = s(e("./LocalStorageDao")), o = s(e("./DrawService")), i = s(e("./Router"));

        function s(e) {
            return e && e.__esModule ? e : {default: e}
        }

        var c, u, l = document.documentElement.clientWidth, f = document.documentElement.clientHeight,
            d = new r.default, m = (new n.default, new o.default(d)), h = [{
                name: "about", match: /[/]about/, onBeforeEnter: function () {
                    v("aboutLink", "active")
                }, onEnter: function () {
                    return console.log("onEnter about")
                }, onLeave: function () {
                    v("aboutLink", "")
                }
            }, {
                name: "game", match: /[/]game/, onBeforeEnter: function () {
                    var e = document.getElementById("gameArea");
                    e && (e.className = "gameArea active", document.getElementById("controlsArea").children[0].src = "img/play.png", document.getElementById("replayArea").className = "replayArea passive", document.getElementById("controlsArea").className = "", v("gameLink", "active"))
                }, onEnter: function () {
                }, onLeave: function () {
                    u.stop(), document.getElementById("gameArea").className = "gameArea passive", document.getElementById("controlsArea").children[0].src = "img/play.png", v("gameLink", ""), u.stop()
                }
            }, {
                name: "showGame", match: /[/]showGame/, onBeforeEnter: function () {
                    var e = document.getElementById("gameArea");
                    e && (e.className = "gameArea active")
                }, onEnter: function () {
                }, onLeave: function () {
                    document.getElementById("gameArea").className = "gameArea passive", document.getElementById("controlsArea").children[0].src = "img/play.png", u.stop()
                }
            }, {
                name: "records", match: /[/]records/, onBeforeEnter: function () {
                    var e = document.getElementById("recordsArea");
                    e.className = "active", e.style.width = document.documentElement.clientWidth, e.style.height = document.documentElement.clientHeight;
                    var t = document.getElementById("recordTableId");
                    t.innerHTML = m.createRecordTableHTML(), t.className = "table", v("recordLink", "active")
                }, onEnter: function () {
                }, onLeave: function () {
                    document.getElementById("recordsArea").className = "recordsArea passive", document.getElementById("recordTableId").className = "tableArea passive", v("recordLink", "")
                }
            }, {
                name: "replays", match: /[/]replays/, onBeforeEnter: function () {
                    v("replayLink", "active");
                    var e = document.getElementById("replaysPage");
                    e.className = "replaysPage active", e.style.width = document.documentElement.clientWidth, e.style.height = document.documentElement.clientHeight;
                    var t = document.getElementById("replaysTableId");
                    (void 0).fbDao.loadGames().once("value").then(function (e) {
                        t.innerHTML = m.createReplayTableHTML(Object.values(e.val())), t.className = "table"
                    })
                }, onEnter: function () {
                    return console.log("onEnter about")
                }, onLeave: function () {
                    v("replayLink", ""), document.getElementById("replaysPage").className = "replaysPage passive", document.getElementById("replaysTableId").className = "tableArea passive"
                }
            }];

        function v(e, t) {
            var a = document.getElementById(e);
            a.className = t, a.parentElement.className = t
        }
    }, {"./Dao": 1, "./DrawService": 2, "./LocalStorageDao": 3, "./Router": 4}]
}, {}, [5]);